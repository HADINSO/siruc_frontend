<div class="administracion-usuarios-container">
  <!-- Notificación -->
  <div 
    *ngIf="mostrarNotificacion" 
    class="notification"
    [ngClass]="'notification-' + tipoMensaje"
  >
    <div class="notification-content">
      <span>{{ mensaje }}</span>
      <button class="notification-close" (click)="cerrarNotificacion()">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
          <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
        </svg>
      </button>
    </div>
  </div>

  <!-- Header -->
  <div class="page-header">
    <div class="header-content">
      <h1>Administracion de Usuarios</h1>
      <p>Gestion de usuarios, roles y permisos del sistema</p>
    </div>
    <button class="btn-nuevo-usuario" (click)="abrirModalCrear()">
      <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
        <path stroke-linecap="round" stroke-linejoin="round" d="M12 4v16m8-8H4" />
      </svg>
      Nuevo Usuario
    </button>
  </div>

  <!-- Estadísticas -->
  <div class="estadisticas-grid">
    <app-stat-card 
      *ngFor="let card of estadisticasCards"
      [data]="card"
    ></app-stat-card>
  </div>

  <!-- Grid de Usuarios -->
  <div class="usuarios-section">
    <!-- Cargando -->
    <div *ngIf="cargandoUsuarios" class="loading-container">
      <div class="spinner"></div>
      <p>Cargando usuarios...</p>
    </div>

    <!-- Sin usuarios -->
    <div *ngIf="!cargandoUsuarios && usuarios.length === 0" class="empty-state">
      <svg xmlns="http://www.w3.org/2000/svg" class="h-16 w-16" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
        <path stroke-linecap="round" stroke-linejoin="round" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z" />
      </svg>
      <h3>No hay usuarios</h3>
      <p>Crea el primer usuario haciendo clic en "Nuevo Usuario"</p>
      <button class="btn-crear-primero" (click)="abrirModalCrear()">
        Crear Primer Usuario
      </button>
    </div>

    <!-- Grid de usuarios -->
    <div *ngIf="!cargandoUsuarios && usuarios.length > 0" class="usuarios-grid">
      <app-user-card 
        *ngFor="let usuario of usuarios"
        [usuario]="usuario"
        (editar)="abrirModalEditar($event)"
        (eliminar)="abrirDeleteConfirmation($event)"
      ></app-user-card>
    </div>
  </div>

  <!-- Modal Crear/Editar Usuario -->
  <app-user-modal
    [mostrar]="mostrarModal"
    [usuarioEditar]="usuarioEnEdicion"
    [roles]="roles"
    [permisos]="permisos"
    [elementos]="elementos"
    (guardar)="onGuardarUsuario($event)"
    (cancelar)="onCancelarModal()"
  ></app-user-modal>

  <!-- Modal Confirmar Eliminación -->
  <app-delete-confirmation
    [mostrar]="mostrarDeleteConfirmation"
    [nombreUsuario]="usuarioAEliminar?.nombre || ''"
    [cargando]="cargandoOperacion"
    (confirmar)="onConfirmarEliminar()"
    (cancelar)="onCancelarDelete()"
  ></app-delete-confirmation>
</div>